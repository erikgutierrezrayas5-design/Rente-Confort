<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>RENTE CONFORT | Arquitectura de Eventos & Mobiliario Luxury</title>
  <meta name="description" content="Especialistas en montaje de eventos de alto nivel en Le√≥n, Gto.">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            serif: ['"Playfair Display"', 'serif'],
            sans: ['"Inter"', 'sans-serif'],
          },
          colors: {
            royal: { 800: '#001b3d', 900: '#001229' },
            gold: { 
              100: '#FCF6BA', 
              300: '#FBF5B7', 
              400: '#BF953F', 
              500: '#B38728', 
              600: '#AA771C' 
            },
            surface: '#f8fafc'
          },
          animation: {
            'fade-up': 'fadeUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards',
            'float': 'float 6s ease-in-out infinite',
          },
          keyframes: {
            fadeUp: {
              '0%': { opacity: '0', transform: 'translateY(20px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    /* Estilos Base Luxury */
    :root {
      --gold-gradient: linear-gradient(135deg, #BF953F 0%, #FCF6BA 25%, #B38728 50%, #FBF5B7 75%, #AA771C 100%);
      --royal-gradient: linear-gradient(to bottom, #001229, #001b3d);
    }
    
    body { background-color: #f8fafc; color: #1e293b; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
    
    /* Textos Met√°licos */
    .text-gold-metallic {
        background: var(--gold-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
    }

    .bg-gold-metallic { background: var(--gold-gradient); }
    
    /* Navegaci√≥n Glassmorphism */
    .glass-nav { 
      background: rgba(0, 18, 41, 0.85); 
      backdrop-filter: blur(12px); 
      border-bottom: 1px solid rgba(191, 149, 63, 0.3); 
    }

    /* Scrollbars Ocultos pero funcionales */
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    
    /* Custom Scrollbar para contenedores internos */
    .custom-scroll::-webkit-scrollbar { width: 4px; }
    .custom-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
    .custom-scroll::-webkit-scrollbar-thumb { background: #BF953F; border-radius: 4px; }

    /* Cards y Sombras */
    .luxury-card {
        background: white;
        border: 1px solid rgba(0,0,0,0.05);
        box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1);
        transition: all 0.4s ease;
    }
    .luxury-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px -10px rgba(191, 149, 63, 0.2);
        border-color: rgba(191, 149, 63, 0.4);
    }

    /* --- SISTEMA DE COMENTARIOS --- */
    .comments-wrapper {
        display: flex;
        overflow-x: auto;
        gap: 20px;
        padding: 20px 5px;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
    }
    
    .comment-card {
        min-width: 300px;
        max-width: 320px;
        scroll-snap-align: center;
        background: white;
        border-radius: 16px;
        padding: 20px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        border: 1px solid rgba(0,0,0,0.05);
        display: flex;
        flex-direction: column;
    }

    .nested-thread {
        margin-top: 15px;
        padding-left: 12px;
        border-left: 2px solid #e2e8f0;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .reaction-btn {
        transition: transform 0.2s;
        cursor: pointer;
    }
    .reaction-btn:active { transform: scale(1.3); }
    .reaction-btn.active-like { color: #3b82f6; }
    .reaction-btn.active-love { color: #ef4444; }
    .reaction-btn.active-dislike { color: #64748b; opacity: 0.8; }

    /* --- CHATBOT --- */
    .chat-bubble-user {
        background: var(--royal-gradient);
        color: white;
        border-radius: 18px 18px 0 18px;
        box-shadow: 0 4px 10px rgba(0,27,61,0.2);
    }
    .chat-bubble-bot {
        background: white;
        color: #334155;
        border: 1px solid #e2e8f0;
        border-radius: 18px 18px 18px 0;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    /* Animaci√≥n de entrada */
    .fade-in-up { animation: fadeUp 0.5s ease forwards; }

    /* Mobile Tweaks */
    @media (max-width: 768px) {
        .mobile-stack { flex-direction: column; }
        .mobile-full { width: 100%; }
        .hero-title { font-size: 2.5rem !important; }
    }
  </style>
</head>
<body class="antialiased font-sans">

  <nav class="fixed top-0 w-full z-50 glass-nav transition-all duration-300">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <a class="flex items-center gap-3 group cursor-pointer" href="#inicio">
        <div class="w-9 h-9 border border-gold-400 flex items-center justify-center rounded bg-royal-900 group-hover:bg-gold-400 transition duration-500">
          <i class='bx bxs-crown text-gold-400 text-lg group-hover:text-royal-900'></i>
        </div>
        <div class="leading-none">
          <h1 class="text-lg font-serif font-bold text-white tracking-widest">RENTE<span class="text-gold-400">CONFORT</span></h1>
        </div>
      </a> 
      
      <div class="hidden lg:flex items-center gap-8 text-[11px] font-bold uppercase tracking-[0.2em] text-slate-300">
        <a class="hover:text-gold-400 transition-colors" href="#coleccion">Colecci√≥n</a>
        <a class="hover:text-gold-400 transition-colors" href="#cotizador">Cotizador</a>
        <a class="hover:text-gold-400 transition-colors" href="#opiniones">Opiniones</a>
        <a class="hover:text-gold-400 transition-colors" href="#ubicacion">Ubicaci√≥n</a>
      </div>

      <button onclick="toggleMobileMenu()" class="lg:hidden text-gold-400 text-2xl focus:outline-none">
        <i class='bx bx-menu'></i>
      </button>

      <a href="javascript:toggleChat()" class="hidden lg:flex items-center gap-2 px-5 py-2 bg-gold-metallic hover:opacity-90 text-royal-900 font-bold text-xs uppercase tracking-widest rounded-sm transition-all shadow-lg">
        <span>Concierge</span> <i class='bx bxs-chat'></i>
      </a>
    </div>

    <div id="mobile-menu" class="fixed inset-0 bg-royal-900 z-40 transform translate-x-full transition-transform duration-300 flex flex-col items-center justify-center gap-8 lg:hidden">
        <button onclick="toggleMobileMenu()" class="absolute top-6 right-6 text-gold-400 text-3xl"><i class='bx bx-x'></i></button>
        <a onclick="toggleMobileMenu()" href="#inicio" class="text-2xl font-serif text-white hover:text-gold-400">Inicio</a>
        <a onclick="toggleMobileMenu()" href="#coleccion" class="text-2xl font-serif text-white hover:text-gold-400">Colecci√≥n</a>
        <a onclick="toggleMobileMenu()" href="#cotizador" class="text-2xl font-serif text-white hover:text-gold-400">Cotizador</a>
        <a onclick="toggleMobileMenu()" href="#opiniones" class="text-2xl font-serif text-white hover:text-gold-400">Opiniones</a>
        <a onclick="toggleMobileMenu(); toggleChat()" href="#" class="text-gold-400 font-bold uppercase tracking-widest border border-gold-400 px-6 py-3 rounded">Abrir Chat</a>
    </div>
  </nav>

  <header id="inicio" class="relative h-screen min-h-[600px] flex items-center justify-center overflow-hidden bg-royal-900">
    <div class="absolute inset-0 z-0">
      <div class="absolute inset-0 bg-gradient-to-b from-royal-900/90 via-royal-900/50 to-royal-900 z-10"></div>
      <img src="https://images.unsplash.com/photo-1519167758481-83f550bb49b3?auto=format&fit=crop&q=80&w=2000" class="w-full h-full object-cover animate-[pulse-slow_8s_infinite] scale-105 opacity-60" alt="Boda de Lujo">
    </div>

    <div class="container mx-auto px-6 relative z-20 text-center text-white mt-16">
      <div class="inline-flex items-center gap-4 mb-6 animate-fade-up opacity-0" style="animation-delay: 0.1s;">
        <span class="w-8 h-[1px] bg-gold-400"></span>
        <span class="text-[10px] md:text-xs uppercase tracking-[0.4em] text-gold-400 font-bold">Arquitectura de Eventos</span>
        <span class="w-8 h-[1px] bg-gold-400"></span>
      </div>
      
      <h1 class="hero-title text-5xl md:text-7xl lg:text-8xl font-serif font-medium leading-[1.1] mb-6 animate-fade-up opacity-0" style="animation-delay: 0.3s;">
        Momentos <br> <span class="text-gold-metallic italic">Inolvidables.</span>
      </h1>
      
      <p class="max-w-2xl mx-auto text-slate-300 text-base md:text-lg font-light leading-relaxed mb-10 animate-fade-up opacity-0" style="animation-delay: 0.5s;">
        Transformamos espacios en Le√≥n, Gto. Mobiliario de autor y log√≠stica de precisi√≥n para eventos que trascienden.
      </p>
      
      <div class="flex flex-col sm:flex-row justify-center gap-4 animate-fade-up opacity-0" style="animation-delay: 0.7s;">
        <button onclick="document.getElementById('cotizador').scrollIntoView()" class="px-8 py-4 bg-white text-royal-900 font-bold text-xs tracking-[0.2em] uppercase hover:bg-gold-400 transition-colors duration-300">
          Dise√±ar Evento
        </button>
        <button onclick="toggleChat()" class="px-8 py-4 border border-white/30 backdrop-blur-sm text-white font-bold text-xs tracking-[0.2em] uppercase hover:bg-white/10 transition-colors">
          Asesor√≠a Express
        </button>
      </div>
    </div>
  </header>

  <section id="cotizador" class="py-20 bg-surface relative">
    <div class="container mx-auto px-4 md:px-6">
      <div class="text-center mb-10">
        <h2 class="text-3xl md:text-4xl font-serif text-royal-900 mb-2">Dise√±a tu Experiencia</h2>
        <div class="w-20 h-1 bg-gold-400 mx-auto"></div>
      </div>

      <div class="flex flex-col lg:flex-row gap-6 max-w-7xl mx-auto items-start">
        
        <div class="w-full lg:w-2/3 bg-white rounded-xl shadow-xl overflow-hidden order-2 lg:order-1">
          <div class="sticky top-0 bg-white z-10 px-4 py-4 border-b border-slate-100 flex gap-2 overflow-x-auto scrollbar-hide">
            <button onclick="filterProducts('all')" class="cat-btn active whitespace-nowrap px-4 py-2 rounded-full text-[11px] font-bold uppercase tracking-wider bg-royal-900 text-white transition shadow-md" data-cat="all">Todo</button>
            <button onclick="filterProducts('Carpas')" class="cat-btn whitespace-nowrap px-4 py-2 rounded-full text-[11px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 hover:text-royal-900 transition" data-cat="Carpas">Carpas</button>
            <button onclick="filterProducts('Mobiliario')" class="cat-btn whitespace-nowrap px-4 py-2 rounded-full text-[11px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 hover:text-royal-900 transition" data-cat="Mobiliario">Mobiliario</button>
            <button onclick="filterProducts('Manteler√≠a')" class="cat-btn whitespace-nowrap px-4 py-2 rounded-full text-[11px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 hover:text-royal-900 transition" data-cat="Manteler√≠a">Manteler√≠a</button>
            <button onclick="filterProducts('Extras')" class="cat-btn whitespace-nowrap px-4 py-2 rounded-full text-[11px] font-bold uppercase tracking-wider bg-slate-100 text-slate-500 hover:text-royal-900 transition" data-cat="Extras">Extras</button>
          </div>

          <div id="products-list" class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 lg:p-6 max-h-[600px] overflow-y-auto custom-scroll">
            </div>
        </div>

        <div class="w-full lg:w-1/3 order-1 lg:order-2">
            <div class="bg-royal-900 text-white rounded-xl shadow-2xl overflow-hidden sticky top-24">
                <div class="p-6 border-b border-white/10 flex justify-between items-center cursor-pointer lg:cursor-default" onclick="toggleCartMobile()">
                    <div>
                        <h3 class="text-xl font-serif text-gold-400">Tu Cotizaci√≥n</h3>
                        <p class="text-xs text-slate-400" id="item-count-label">0 art√≠culos seleccionados</p>
                    </div>
                    <i class='bx bxs-chevron-down lg:hidden text-2xl transition-transform' id="cart-chevron"></i>
                </div>

                <div id="cart-body" class="transition-all duration-300 overflow-hidden max-h-0 lg:max-h-[500px]">
                    <div id="selected-items-container" class="p-6 max-h-[250px] overflow-y-auto custom-scroll space-y-3 min-h-[100px]">
                        <p class="text-slate-500 text-sm text-center italic py-4">Selecciona elementos para comenzar.</p>
                    </div>

                    <div class="bg-royal-800 p-6">
                        <div class="flex justify-between items-end mb-4">
                            <span class="text-xs uppercase tracking-widest text-slate-400">Estimado</span>
                            <span id="total-display" class="text-3xl font-serif font-bold text-white">$0.00</span>
                        </div>
                        <button onclick="openChatWithCart()" class="w-full bg-gold-metallic text-royal-900 font-bold py-3 rounded shadow-lg hover:brightness-110 transition flex items-center justify-center gap-2 text-sm uppercase tracking-wider">
                            <span>Confirmar Disponibilidad</span>
                            <i class='bx bxl-whatsapp text-lg'></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

      </div>
    </div>
  </section>

  <section id="opiniones" class="py-20 bg-white border-t border-slate-100">
    <div class="container mx-auto px-4">
        <div class="flex justify-between items-end mb-8 px-2">
            <div>
                <h2 class="text-3xl font-serif text-royal-900">Experiencias Reales</h2>
                <p class="text-slate-500 text-sm mt-1">Lo que dicen nuestros clientes.</p>
            </div>
            <div class="hidden md:flex gap-2">
                <button onclick="scrollReviews('left')" class="w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center hover:bg-gold-400 hover:text-white transition"><i class='bx bx-chevron-left'></i></button>
                <button onclick="scrollReviews('right')" class="w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center hover:bg-gold-400 hover:text-white transition"><i class='bx bx-chevron-right'></i></button>
            </div>
        </div>

        <div class="comments-wrapper custom-scroll" id="reviews-container">
            </div>

        <div class="max-w-xl mx-auto mt-12 text-center">
            <button onclick="document.getElementById('new-review-modal').classList.remove('hidden')" class="text-royal-900 font-bold border-b-2 border-gold-400 pb-1 hover:text-gold-500 transition text-sm uppercase tracking-widest">
                <i class='bx bx-plus'></i> Agregar mi experiencia
            </button>
        </div>
    </div>
  </section>

  <footer id="ubicacion" class="bg-royal-900 text-white pt-16 pb-6 border-t border-gold-400/30">
    <div class="container mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-10">
        <div>
            <h3 class="font-serif text-2xl text-gold-400 mb-4">RENTE CONFORT</h3>
            <p class="text-slate-400 text-sm leading-relaxed mb-4">
                Redefiniendo el est√°ndar de lujo en el Baj√≠o. Cada evento es una obra maestra de log√≠stica y dise√±o.
            </p>
            <div class="flex gap-4 text-xl text-gold-400">
                <i class='bx bxl-instagram cursor-pointer hover:text-white'></i>
                <i class='bx bxl-facebook cursor-pointer hover:text-white'></i>
            </div>
        </div>
        <div>
            <h4 class="font-bold text-xs uppercase tracking-[0.2em] mb-6 text-white">Contacto Directo</h4>
            <div class="space-y-4 text-sm text-slate-300">
                <p class="flex items-center gap-3"><i class='bx bx-map text-gold-400'></i> Calle Tallin 145, Col. Agua Azul, Le√≥n, Gto.</p>
                <p class="flex items-center gap-3"><i class='bx bx-phone text-gold-400'></i> 477 821 7435</p>
                <p class="flex items-center gap-3"><i class='bx bx-envelope text-gold-400'></i> concierge@renteconfort.mx</p>
            </div>
        </div>
        <div>
            <h4 class="font-bold text-xs uppercase tracking-[0.2em] mb-6 text-white">Horario Showroom</h4>
            <ul class="text-sm text-slate-300 space-y-2">
                <li class="flex justify-between border-b border-white/10 pb-2"><span>Lun - Vie</span> <span>9:00 AM - 7:00 PM</span></li>
                <li class="flex justify-between border-b border-white/10 pb-2"><span>S√°bado</span> <span>9:00 AM - 2:00 PM</span></li>
                <li class="flex justify-between pt-2"><span class="text-gold-400">Domingo</span> <span>Cita Previa</span></li>
            </ul>
        </div>
    </div>
    <div class="text-center mt-12 pt-6 border-t border-white/5 text-[10px] text-slate-500 uppercase tracking-widest">
        &copy; 2026 Rente Confort. Todos los derechos reservados.
    </div>
  </footer>

  <div class="fixed bottom-4 right-4 z-[100] flex flex-col items-end">
    
    <div id="chat-window" class="hidden w-[90vw] md:w-[380px] bg-white rounded-2xl shadow-2xl flex flex-col mb-4 overflow-hidden border border-slate-200 transform transition-all duration-300 origin-bottom-right animate-fade-up h-[500px] max-h-[80vh]">
      
      <div class="bg-royal-900 p-4 flex justify-between items-center shrink-0">
        <div class="flex items-center gap-3">
          <div class="relative">
             <img src="https://img.freepik.com/free-photo/handsome-confident-smiling-man-with-hands-crossed-chest_176420-18743.jpg?w=200" class="w-10 h-10 rounded-full border-2 border-gold-400 object-cover">
            <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-royal-900 rounded-full"></span>
          </div>
          <div>
            <p class="font-bold text-white text-sm">Santiago</p>
            <p class="text-[10px] text-gold-400 uppercase tracking-wider">Concierge Digital</p>
          </div>
        </div>
        <button onclick="toggleChat()" class="text-slate-400 hover:text-white"><i class='bx bx-x text-2xl'></i></button>
      </div>

      <div id="chat-content" class="flex-1 overflow-y-auto p-4 bg-slate-50 space-y-4 custom-scroll">
         </div>

      <div class="bg-white border-t border-slate-100 shrink-0">
         <div id="chat-suggestions" class="px-4 py-3 flex gap-2 overflow-x-auto whitespace-nowrap scrollbar-hide bg-slate-50/50">
             </div>
         <div class="p-3 flex gap-2 items-center">
            <input type="text" id="chat-input" placeholder="Escribe un mensaje..." 
                   class="flex-1 bg-slate-100 rounded-full px-4 py-2 text-sm focus:ring-1 focus:ring-gold-400 focus:bg-white outline-none transition text-slate-700"
                   onkeypress="if(event.key === 'Enter') handleUserMessage()">
            <button onclick="handleUserMessage()" class="w-9 h-9 bg-royal-900 text-white rounded-full flex items-center justify-center hover:bg-gold-500 transition shadow-lg transform active:scale-95">
              <i class='bx bxs-send'></i>
            </button>
         </div>
      </div>
    </div>

    <button id="chat-toggle-btn" onclick="toggleChat()" class="group relative w-14 h-14 bg-royal-900 rounded-full shadow-2xl flex items-center justify-center border border-gold-400 hover:scale-110 transition duration-300 z-50">
      <i class='bx bxs-message-dots text-2xl text-white group-hover:hidden'></i>
      <i class='bx bx-x text-3xl text-white hidden group-hover:block'></i>
      <span class="absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[9px] font-bold flex items-center justify-center rounded-full border border-royal-900 animate-bounce">1</span>
    </button>
  </div>

  <div id="new-review-modal" class="hidden fixed inset-0 z-[110] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4">
      <div class="bg-white rounded-xl max-w-md w-full p-6 relative animate-fade-up">
          <button onclick="document.getElementById('new-review-modal').classList.add('hidden')" class="absolute top-4 right-4 text-slate-400 hover:text-red-500"><i class='bx bx-x text-2xl'></i></button>
          <h3 class="text-xl font-serif text-royal-900 mb-4">Comparte tu Experiencia</h3>
          <input type="text" id="review-name" placeholder="Tu Nombre" class="w-full mb-3 p-3 border rounded focus:border-gold-400 outline-none text-sm">
          <textarea id="review-text" rows="3" placeholder="¬øQu√© te pareci√≥ nuestro servicio?" class="w-full mb-3 p-3 border rounded focus:border-gold-400 outline-none text-sm resize-none"></textarea>
          <div class="flex gap-2 mb-4 justify-center">
              <i class="fas fa-star text-slate-300 text-xl cursor-pointer hover:text-gold-500" onclick="setRating(1)"></i>
              <i class="fas fa-star text-slate-300 text-xl cursor-pointer hover:text-gold-500" onclick="setRating(2)"></i>
              <i class="fas fa-star text-slate-300 text-xl cursor-pointer hover:text-gold-500" onclick="setRating(3)"></i>
              <i class="fas fa-star text-slate-300 text-xl cursor-pointer hover:text-gold-500" onclick="setRating(4)"></i>
              <i class="fas fa-star text-slate-300 text-xl cursor-pointer hover:text-gold-500" onclick="setRating(5)"></i>
          </div>
          <button onclick="submitNewReview()" class="w-full bg-royal-900 text-white font-bold py-3 rounded hover:bg-gold-500 transition">Publicar</button>
      </div>
  </div>

  <script>
    // --- 1. L√ìGICA DE UI GENERAL ---
    function toggleMobileMenu() {
        const menu = document.getElementById('mobile-menu');
        if(menu.classList.contains('translate-x-full')) {
            menu.classList.remove('translate-x-full');
        } else {
            menu.classList.add('translate-x-full');
        }
    }

    function toggleCartMobile() {
        const body = document.getElementById('cart-body');
        const chevron = document.getElementById('cart-chevron');
        
        if (body.style.maxHeight === '500px') {
            body.style.maxHeight = '0px';
            chevron.style.transform = 'rotate(0deg)';
        } else {
            body.style.maxHeight = '500px';
            chevron.style.transform = 'rotate(180deg)';
        }
    }

    // Inicializar carrito abierto en desktop
    if(window.innerWidth >= 1024) document.getElementById('cart-body').style.maxHeight = '500px';

    // --- 2. L√ìGICA DEL COTIZADOR (INVENTARIO) ---
    const inventory = [
      { id: 101, name: "Carpa Estructural 12x24m", price: 12000, category: "Carpas", img: "bx-building" },
      { id: 102, name: "Carpa Transparente", price: 15000, category: "Carpas", img: "bx-window" },
      { id: 201, name: "Silla Crossback", price: 55, category: "Mobiliario", img: "bx-chair" },
      { id: 202, name: "Mesa Parota (12px)", price: 550, category: "Mobiliario", img: "bx-table" },
      { id: 203, name: "Sala Lounge Velvet", price: 1200, category: "Mobiliario", img: "bx-sofa" },
      { id: 301, name: "Mantel Terciopelo", price: 180, category: "Manteler√≠a", img: "bx-layer" },
      { id: 302, name: "Servilleta Lino", price: 12, category: "Manteler√≠a", img: "bx-bookmark" },
      { id: 401, name: "Pista Baile Charol", price: 300, category: "Extras", img: "bx-grid-alt" },
      { id: 402, name: "Iluminaci√≥n Arq.", price: 1200, category: "Extras", img: "bx-bulb" }
    ];

    let cart = {};

    function renderProducts(filter = 'all') {
        const list = document.getElementById('products-list');
        list.innerHTML = '';
        
        const filtered = filter === 'all' ? inventory : inventory.filter(i => i.category === filter);

        filtered.forEach(item => {
            const qty = cart[item.id] ? cart[item.id].qty : 0;
            const btnClass = qty > 0 ? 'bg-gold-500 text-white' : 'bg-slate-100 text-royal-900';
            
            list.innerHTML += `
            <div class="flex items-center justify-between p-3 border border-slate-100 rounded-lg hover:shadow-md transition bg-white animate-fade-up">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-royal-900/5 rounded flex items-center justify-center text-royal-900">
                        <i class='bx ${item.img} text-xl'></i>
                    </div>
                    <div>
                        <h4 class="text-sm font-bold text-royal-900">${item.name}</h4>
                        <p class="text-xs text-gold-500 font-bold">$${item.price} MXN</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="updateCart(${item.id}, -1)" class="w-6 h-6 rounded-full bg-slate-200 text-slate-600 flex items-center justify-center hover:bg-red-500 hover:text-white transition">-</button>
                    <span class="text-sm font-bold w-4 text-center">${qty}</span>
                    <button onclick="updateCart(${item.id}, 1)" class="w-6 h-6 rounded-full bg-royal-900 text-white flex items-center justify-center hover:bg-gold-500 transition">+</button>
                </div>
            </div>`;
        });
    }

    function updateCart(id, change) {
        const item = inventory.find(i => i.id === id);
        if(!cart[id]) cart[id] = { ...item, qty: 0 };
        
        cart[id].qty += change;
        if(cart[id].qty <= 0) delete cart[id];
        
        renderCart();
        renderProducts(document.querySelector('.cat-btn.active').dataset.cat);
    }

    function renderCart() {
        const container = document.getElementById('selected-items-container');
        let total = 0;
        let count = 0;
        let html = '';

        Object.values(cart).forEach(item => {
            total += item.price * item.qty;
            count += item.qty;
            html += `
            <div class="flex justify-between items-center text-sm text-white/90 border-b border-white/10 pb-1">
                <span>${item.qty}x ${item.name}</span>
                <span class="font-bold">$${(item.price * item.qty).toLocaleString()}</span>
            </div>`;
        });

        container.innerHTML = html || '<p class="text-slate-500 text-sm text-center italic py-4">Carrito vac√≠o</p>';
        document.getElementById('total-display').innerText = `$${total.toLocaleString()}`;
        document.getElementById('item-count-label').innerText = `${count} art√≠culos seleccionados`;
    }

    function filterProducts(cat) {
        document.querySelectorAll('.cat-btn').forEach(b => {
            b.classList.remove('bg-royal-900', 'text-white');
            b.classList.add('bg-slate-100', 'text-slate-500');
        });
        const activeBtn = document.querySelector(`.cat-btn[data-cat="${cat}"]`);
        activeBtn.classList.remove('bg-slate-100', 'text-slate-500');
        activeBtn.classList.add('bg-royal-900', 'text-white');
        activeBtn.classList.add('active');
        renderProducts(cat);
    }

    // --- 3. SISTEMA DE COMENTARIOS RECURSIVO ---
    
    // Estructura de datos inicial
    let commentsData = [
        {
            id: 1, user: "Mariana L.", text: "La carpa transparente transform√≥ mi boda. ¬°Incre√≠ble!", rating: 5, date: "Hace 2 d√≠as",
            reactions: { like: 12, love: 4, dislike: 0 },
            replies: [
                { id: 11, user: "Rente Confort", isBrand: true, text: "Gracias Mariana, fue un honor ser parte de tu d√≠a.", reactions: { like: 2, love: 1, dislike: 0 }, replies: [] }
            ]
        },
        {
            id: 2, user: "Arq. Roberto S.", text: "Log√≠stica impecable. Llegaron a tiempo y el montaje fue limpio.", rating: 5, date: "Hace 1 semana",
            reactions: { like: 8, love: 0, dislike: 0 },
            replies: []
        }
    ];

    let currentRating = 5;

    function renderComments() {
        const container = document.getElementById('reviews-container');
        container.innerHTML = commentsData.map(c => createCommentHTML(c)).join('');
    }

    // Funci√≥n Recursiva para generar HTML
    function createCommentHTML(comment, isChild = false) {
        const stars = comment.rating ? Array(comment.rating).fill('<i class="fas fa-star text-yellow-400 text-xs"></i>').join('') : '';
        const brandBadge = comment.isBrand ? '<span class="bg-blue-100 text-royal-900 text-[9px] px-1 rounded font-bold ml-1 border border-blue-200">OFICIAL</span>' : '';
        const bgClass = comment.isBrand ? 'bg-blue-50/50' : 'bg-transparent';
        
        let repliesHTML = '';
        if (comment.replies && comment.replies.length > 0) {
            repliesHTML = `<div class="nested-thread">${comment.replies.map(r => createCommentHTML(r, true)).join('')}</div>`;
        }

        return `
        <div class="${isChild ? 'w-full mb-2' : 'comment-card'} ${bgClass}">
            <div class="flex items-start justify-between mb-2">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-full ${comment.isBrand ? 'bg-royal-900 text-gold-400' : 'bg-slate-200 text-slate-600'} flex items-center justify-center font-bold text-xs">
                        ${comment.isBrand ? '<i class="bx bxs-crown"></i>' : comment.user.charAt(0)}
                    </div>
                    <div>
                        <h4 class="text-xs font-bold text-royal-900 flex items-center">${comment.user} ${brandBadge}</h4>
                        ${stars ? `<div class="flex">${stars}</div>` : `<span class="text-[10px] text-slate-400">Respuesta</span>`}
                    </div>
                </div>
                ${!isChild ? `<span class="text-[10px] text-slate-400">${comment.date || ''}</span>` : ''}
            </div>
            
            <p class="text-xs text-slate-600 leading-relaxed mb-3">${comment.text}</p>
            
            <div class="flex items-center gap-4 border-t border-slate-100 pt-2 mt-auto">
                <div class="flex gap-3 text-slate-400 text-xs">
                    <button onclick="react(${comment.id}, 'like', this)" class="reaction-btn hover:text-blue-500 flex items-center gap-1">
                        <i class="far fa-thumbs-up"></i> <span>${comment.reactions.like}</span>
                    </button>
                    <button onclick="react(${comment.id}, 'love', this)" class="reaction-btn hover:text-red-500 flex items-center gap-1">
                        <i class="far fa-heart"></i> <span>${comment.reactions.love}</span>
                    </button>
                    <button onclick="react(${comment.id}, 'dislike', this)" class="reaction-btn hover:text-slate-600 flex items-center gap-1">
                        <i class="far fa-thumbs-down"></i> <span>${comment.reactions.dislike}</span>
                    </button>
                </div>
                <button onclick="toggleReplyForm(${comment.id})" class="text-[10px] font-bold text-royal-900 hover:text-gold-500 ml-auto uppercase tracking-wide">
                    Responder
                </button>
            </div>

            <div id="reply-form-${comment.id}" class="hidden mt-3 pt-2 border-t border-dashed border-slate-200">
                <input type="text" id="input-${comment.id}" placeholder="Escribe una respuesta..." class="w-full text-xs bg-slate-50 border border-slate-200 rounded px-2 py-1 mb-2 outline-none focus:border-gold-400">
                <div class="flex justify-end gap-2">
                    <button onclick="toggleReplyForm(${comment.id})" class="text-[10px] text-slate-500">Cancelar</button>
                    <button onclick="submitReply(${comment.id})" class="bg-royal-900 text-white text-[10px] px-3 py-1 rounded hover:bg-gold-500 transition">Enviar</button>
                </div>
            </div>

            ${repliesHTML}
        </div>`;
    }

    // Funciones de utilidad para comentarios
    function findCommentRecursive(comments, id) {
        for (let c of comments) {
            if (c.id === id) return c;
            if (c.replies) {
                const found = findCommentRecursive(c.replies, id);
                if (found) return found;
            }
        }
        return null;
    }

    function react(id, type, btn) {
        const comment = findCommentRecursive(commentsData, id);
        if (comment) {
            // L√≥gica simple de toggle visual
            const icon = btn.querySelector('i');
            
            if (btn.classList.contains(`active-${type}`)) {
                btn.classList.remove(`active-${type}`);
                comment.reactions[type]--;
                if(type === 'like' || type === 'dislike') icon.classList.replace('fas', 'far');
                if(type === 'love') icon.classList.replace('fas', 'far');
            } else {
                btn.classList.add(`active-${type}`);
                comment.reactions[type]++;
                if(type === 'like' || type === 'dislike') icon.classList.replace('far', 'fas');
                if(type === 'love') icon.classList.replace('far', 'fas');
            }
            btn.querySelector('span').innerText = comment.reactions[type];
        }
    }

    function toggleReplyForm(id) {
        const form = document.getElementById(`reply-form-${id}`);
        form.classList.toggle('hidden');
    }

    function submitReply(parentId) {
        const input = document.getElementById(`input-${parentId}`);
        const text = input.value.trim();
        if(!text) return;

        const parent = findCommentRecursive(commentsData, parentId);
        if(parent) {
            const newReply = {
                id: Date.now(),
                user: "Usuario", // En producci√≥n, tomar√≠a nombre real
                text: text,
                isBrand: false,
                reactions: { like: 0, love: 0, dislike: 0 },
                replies: []
            };
            if(!parent.replies) parent.replies = [];
            parent.replies.push(newReply);
            
            // Re-renderizar todo para mantener orden
            renderComments();
        }
    }

    function setRating(n) {
        currentRating = n;
        const stars = document.querySelectorAll('#new-review-modal .fa-star');
        stars.forEach((s, i) => {
            if (i < n) s.classList.add('text-yellow-400');
            else s.classList.remove('text-yellow-400');
        });
    }

    function submitNewReview() {
        const name = document.getElementById('review-name').value;
        const text = document.getElementById('review-text').value;
        
        if(name && text) {
            commentsData.unshift({
                id: Date.now(),
                user: name,
                text: text,
                rating: currentRating,
                date: "Ahora",
                reactions: { like: 0, love: 0, dislike: 0 },
                replies: []
            });
            renderComments();
            document.getElementById('new-review-modal').classList.add('hidden');
            // Reset fields
            document.getElementById('review-name').value = '';
            document.getElementById('review-text').value = '';
        }
    }

    function scrollReviews(dir) {
        const container = document.getElementById('reviews-container');
        const scrollAmount = 320;
        if(dir === 'left') container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
        else container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
    }


    // --- 4. CHATBOT INTELIGENTE "SANTIAGO" ---
    
    let chatState = {
        step: 'IDLE',
        name: '',
        type: '',
        context: {} // Para guardar si viene de carrito, etc.
    };

    function toggleChat() {
        const win = document.getElementById('chat-window');
        win.classList.toggle('hidden');
        
        // Si se abre por primera vez
        if(!win.classList.contains('hidden') && chatState.step === 'IDLE') {
            botThinking(() => {
                addBotMsg("¬°Hola! Soy Santiago. üëã Bienvenido a la experiencia Rente Confort. ¬øCu√°l es tu nombre?", []);
                chatState.step = 'WAITING_NAME';
            });
        }
    }

    function openChatWithCart() {
        const win = document.getElementById('chat-window');
        if(win.classList.contains('hidden')) toggleChat();
        
        // Override state for Cart flow
        chatState.context.hasCart = true;
        
        setTimeout(() => {
             addBotMsg("Veo que tienes una selecci√≥n de productos interesante. üßê ¬øQuieres que revise la disponibilidad para esos art√≠culos?", ["S√≠, revisar fechas", "Solo estoy viendo"]);
             chatState.step = 'CART_FLOW';
        }, 800);
    }

    function handleUserMessage() {
        const input = document.getElementById('chat-input');
        const text = input.value.trim();
        if(!text) return;

        addUserMsg(text);
        input.value = '';
        
        botThinking(() => processLogic(text));
    }

    function processLogic(text) {
        const lower = text.toLowerCase();

        // M√°quina de Estados
        switch (chatState.step) {
            case 'WAITING_NAME':
                chatState.name = text;
                chatState.step = 'WAITING_EVENT';
                addBotMsg(`Un gusto, ${chatState.name}. ¬øQu√© tipo de evento est√°s planeando? (Boda, XV A√±os, Empresarial...)`, ["Boda", "Empresarial", "Cumplea√±os"]);
                break;

            case 'WAITING_EVENT':
                chatState.type = text;
                chatState.step = 'MENU';
                addBotMsg(`Excelente. Somos especialistas en ${chatState.type}. ¬øC√≥mo puedo ayudarte hoy?`, ["Ver Cat√°logo", "Ubicaci√≥n Showroom", "Hablar con Humano"]);
                break;

            case 'CART_FLOW':
                if(lower.includes('s√≠') || lower.includes('revisar')) {
                    sendWhatsAppCart();
                } else {
                    addBotMsg("Entendido. Puedes seguir navegando. Si necesitas algo m√°s, aqu√≠ estoy.", ["Cerrar Chat"]);
                    chatState.step = 'CLOSING';
                }
                break;

            case 'MENU':
                if(lower.includes('ubicaci√≥n') || lower.includes('donde') || lower.includes('showroom')) {
                    showLocation();
                } else if (lower.includes('catalogo') || lower.includes('ver')) {
                    addBotMsg("Puedes ver todo nuestro inventario en la secci√≥n 'Colecci√≥n' arriba. ¬øTe acompa√±o ah√≠?", ["Ir a Colecci√≥n"]);
                    // Logic to scroll
                    document.getElementById('coleccion').scrollIntoView({behavior:'smooth'});
                } else if (lower.includes('humano') || lower.includes('persona')) {
                    addBotMsg("Claro, te comparto mi WhatsApp directo para una atenci√≥n personalizada.", ["Abrir WhatsApp"]);
                    addLinkBtn("https://wa.me/524778217435", "Contactar a Santiago");
                    delayedClose();
                } else {
                    addBotMsg("No estoy seguro de entender. ¬øQuieres ver nuestra ubicaci√≥n o el cat√°logo?", ["Ubicaci√≥n", "Cat√°logo"]);
                }
                break;
            
            case 'CLOSING':
                addBotMsg("¬°Que tengas un excelente d√≠a! Minimizar√© el chat para que veas la p√°gina mejor. üëã", []);
                delayedClose();
                break;

            default:
                addBotMsg("¬øEn qu√© m√°s puedo ayudarte?", ["Ver Carrito", "Ubicaci√≥n"]);
                chatState.step = 'MENU';
        }
    }

    // Funciones de Respuesta Bot
    function botThinking(callback) {
        const chatContent = document.getElementById('chat-content');
        const id = 'thinking-' + Date.now();
        chatContent.innerHTML += `
            <div id="${id}" class="flex gap-2 fade-in-up">
                <div class="w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center"><i class="bx bx-dots-horizontal-rounded animate-pulse text-royal-900"></i></div>
                <div class="text-xs text-slate-400 mt-2">Escribiendo...</div>
            </div>`;
        scrollToBottom();

        setTimeout(() => {
            document.getElementById(id).remove();
            callback();
        }, 1200); // Retardo artificial para realismo
    }

    function addBotMsg(text, suggestions) {
        const chatContent = document.getElementById('chat-content');
        chatContent.innerHTML += `
            <div class="flex gap-2 max-w-[90%] fade-in-up">
                <img src="https://img.freepik.com/free-photo/handsome-confident-smiling-man-with-hands-crossed-chest_176420-18743.jpg?w=200" class="w-8 h-8 rounded-full border border-gold-400 object-cover shrink-0 mt-1">
                <div class="chat-bubble-bot p-3 text-sm">
                    ${text}
                </div>
            </div>`;
        renderSuggestions(suggestions);
        scrollToBottom();
    }

    function addUserMsg(text) {
        const chatContent = document.getElementById('chat-content');
        chatContent.innerHTML += `
            <div class="flex justify-end fade-in-up">
                <div class="chat-bubble-user p-3 text-sm max-w-[85%]">
                    ${text}
                </div>
            </div>`;
        scrollToBottom();
    }

    function renderSuggestions(opts) {
        const container = document.getElementById('chat-suggestions');
        if(opts.length > 0) {
            container.parentElement.classList.remove('hidden');
            container.innerHTML = opts.map(o => `
                <button onclick="document.getElementById('chat-input').value='${o}'; handleUserMessage()" 
                        class="px-3 py-1 bg-white border border-gold-400/30 text-royal-900 rounded-full text-xs hover:bg-gold-400 hover:text-white transition shadow-sm">
                    ${o}
                </button>
            `).join('');
        } else {
            container.innerHTML = '';
        }
    }

    function scrollToBottom() {
        const el = document.getElementById('chat-content');
        el.scrollTop = el.scrollHeight;
    }

    function sendWhatsAppCart() {
        let msg = `Hola Santiago, soy ${chatState.name}. Planeo un(a) ${chatState.type}.\n\n*COTIZACI√ìN SOLICITADA:*\n`;
        let total = 0;
        Object.values(cart).forEach(item => {
            msg += `‚Ä¢ ${item.qty}x ${item.name} - $${item.price * item.qty}\n`;
            total += item.price * item.qty;
        });
        msg += `\n*Total Estimado: $${total.toLocaleString()}*\n¬øTienen disponibilidad?`;
        
        addBotMsg(`He generado tu resumen por $${total.toLocaleString()}. Haz clic abajo para envi√°rmelo.`, []);
        addLinkBtn(`https://wa.me/524778217435?text=${encodeURIComponent(msg)}`, "Enviar a WhatsApp");
        delayedClose();
    }

    function showLocation() {
        addBotMsg("Estamos en Calle Tallin 145, Col. Agua Azul. Aqu√≠ tienes el mapa:", ["Gracias"]);
        const chatContent = document.getElementById('chat-content');
        chatContent.innerHTML += `
            <div class="my-2 rounded-lg overflow-hidden border border-slate-200 shadow-sm fade-in-up ml-10 max-w-[80%]">
               <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3721.4939226297374!2d-101.6666896249658!3d21.13276688054366!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x842bbf61e3895eef%3A0xe544974797055745!2sCalle%20Tallin%20145%2C%20Agua%20Azul%2C%2037250%20Le%C3%B3n%2C%20Gto.!5e0!3m2!1ses-419!2smx!4v1704230000000!5m2!1ses-419!2smx" width="100%" height="150" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>`;
        scrollToBottom();
        chatState.step = 'CLOSING';
    }

    function addLinkBtn(url, label) {
        const chatContent = document.getElementById('chat-content');
        chatContent.innerHTML += `
            <div class="flex justify-center my-2 fade-in-up">
                <a href="${url}" target="_blank" class="flex items-center gap-2 bg-[#25D366] text-white px-5 py-2 rounded-full font-bold shadow hover:bg-[#20ba56] transition text-sm">
                    <i class='bx bxl-whatsapp text-lg'></i> ${label}
                </a>
            </div>`;
        scrollToBottom();
    }

    function delayedClose() {
        setTimeout(() => {
            const win = document.getElementById('chat-window');
            if(!win.classList.contains('hidden')) {
                toggleChat();
                // Reset state partially so if they open again it's friendly
                chatState.step = 'MENU'; 
            }
        }, 5000); // 5 segundos para leer y cierra
    }

    // --- INICIALIZACI√ìN ---
    renderProducts();
    renderComments();

  </script>
</body>
</html>
